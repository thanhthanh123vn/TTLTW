<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xuất Kho - Quản Lý Kho</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .sidebar {
            height: 100vh;
            background-color: #343a40;
            padding-top: 20px;
        }
        .sidebar a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            display: block;
        }
        .sidebar a:hover {
            background-color: #495057;
        }
        .main-content {
            padding: 20px;
        }
        .export-form {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .export-history {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .product-item {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
        }
        .stock-warning {
            color: #dc3545;
            font-size: 0.8em;
            margin-top: 5px;
        }
        .stock-info {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar">
                <h3 class="text-white text-center mb-4">Quản Lý Kho</h3>
                <a href="Home.html"><i class="fas fa-home"></i> Trang Chủ</a>
                <a href="ManageProduct.html"><i class="fas fa-boxes"></i> Sản Phẩm</a>
                <a href="ImportProduct.html"><i class="fas fa-truck"></i> Nhập Kho</a>
                <a href="ExportProduct.html" class="active"><i class="fas fa-shopping-cart"></i> Xuất Kho</a>
                <a href="#"><i class="fas fa-chart-bar"></i> Báo Cáo</a>
                <a href="#"><i class="fas fa-cog"></i> Cài Đặt</a>
            </div>

            <!-- Main Content -->
            <div class="col-md-10 main-content">
                <h2 class="mb-4">Xuất Kho</h2>

                <!-- Export Form -->
                <div class="export-form">
                    <h4 class="mb-3">Thông Tin Xuất Kho</h4>
                    <form id="exportForm">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Mã Đơn Xuất</label>
                                <input type="text" class="form-control" value="XK001" readonly>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Ngày Xuất</label>
                                <input type="date" class="form-control" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Khách Hàng</label>
                                <select class="form-select" required>
                                    <option value="">Chọn khách hàng</option>
                                    <option value="1">Công ty TNHH ABC</option>
                                    <option value="2">Công ty XYZ</option>
                                    <option value="3">Công ty DEF</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Lý Do Xuất</label>
                                <select class="form-select" required>
                                    <option value="">Chọn lý do</option>
                                    <option value="sale">Bán hàng</option>
                                    <option value="transfer">Chuyển kho</option>
                                    <option value="return">Trả hàng</option>
                                    <option value="other">Khác</option>
                                </select>
                            </div>
                        </div>

                        <h5 class="mt-4 mb-3">Danh Sách Sản Phẩm</h5>
                        <div id="productList">
                            <!-- Product items will be added here -->
                            <div class="product-item">
                                <div class="row align-items-center">
                                    <div class="col-md-3">
                                        <label class="form-label">Sản Phẩm</label>
                                        <select class="form-select" required onchange="updateStockInfo(this)">
                                            <option value="">Chọn sản phẩm</option>
                                            <option value="1" data-stock="50">Laptop Dell XPS 13</option>
                                            <option value="2" data-stock="30">iPhone 15 Pro</option>
                                            <option value="3" data-stock="25">Samsung Galaxy S24</option>
                                        </select>
                                        <div class="stock-info">Tồn kho: <span class="stock-count">0</span></div>
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label">Số Lượng</label>
                                        <input type="number" class="form-control" required min="1" onchange="checkStock(this)">
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label">Đơn Giá</label>
                                        <input type="number" class="form-control" required>
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label">Thành Tiền</label>
                                        <input type="text" class="form-control" readonly>
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label">&nbsp;</label>
                                        <button type="button" class="btn btn-danger d-block w-100" onclick="removeProductItem(this)">
                                            <i class="fas fa-trash"></i> Xóa
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button type="button" class="btn btn-secondary mt-3" onclick="addProductItem()">
                            <i class="fas fa-plus"></i> Thêm Sản Phẩm
                        </button>

                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Tổng Tiền</label>
                                    <input type="text" class="form-control" value="0 VNĐ" readonly>
                                </div>
                            </div>
                            <div class="col-md-6 text-end">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Lưu Phiếu Xuất
                                </button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Export History -->
                <div class="export-history">
                    <h4 class="mb-3">Lịch Sử Xuất Kho</h4>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Mã Đơn</th>
                                    <th>Ngày Xuất</th>
                                    <th>Khách Hàng</th>
                                    <th>Lý Do</th>
                                    <th>Số Sản Phẩm</th>
                                    <th>Tổng Tiền</th>
                                    <th>Trạng Thái</th>
                                    <th>Thao Tác</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>XK001</td>
                                    <td>15/03/2024</td>
                                    <td>Công ty TNHH ABC</td>
                                    <td>Bán hàng</td>
                                    <td>3</td>
                                    <td>75,000,000đ</td>
                                    <td><span class="badge bg-success">Hoàn thành</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                        <button class="btn btn-sm btn-primary"><i class="fas fa-print"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>XK002</td>
                                    <td>14/03/2024</td>
                                    <td>Công ty XYZ</td>
                                    <td>Chuyển kho</td>
                                    <td>5</td>
                                    <td>125,000,000đ</td>
                                    <td><span class="badge bg-success">Hoàn thành</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                        <button class="btn btn-sm btn-primary"><i class="fas fa-print"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function addProductItem() {
            const productList = document.getElementById('productList');
            const newItem = document.createElement('div');
            newItem.className = 'product-item';
            newItem.innerHTML = `
                <div class="row align-items-center">
                    <div class="col-md-3">
                        <label class="form-label">Sản Phẩm</label>
                        <select class="form-select" required onchange="updateStockInfo(this)">
                            <option value="">Chọn sản phẩm</option>
                            <option value="1" data-stock="50">Laptop Dell XPS 13</option>
                            <option value="2" data-stock="30">iPhone 15 Pro</option>
                            <option value="3" data-stock="25">Samsung Galaxy S24</option>
                        </select>
                        <div class="stock-info">Tồn kho: <span class="stock-count">0</span></div>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Số Lượng</label>
                        <input type="number" class="form-control" required min="1" onchange="checkStock(this)">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Đơn Giá</label>
                        <input type="number" class="form-control" required>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Thành Tiền</label>
                        <input type="text" class="form-control" readonly>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">&nbsp;</label>
                        <button type="button" class="btn btn-danger d-block w-100" onclick="removeProductItem(this)">
                            <i class="fas fa-trash"></i> Xóa
                        </button>
                    </div>
                </div>
            `;
            productList.appendChild(newItem);
        }

        function removeProductItem(button) {
            const productItem = button.closest('.product-item');
            productItem.remove();
        }

        function updateStockInfo(select) {
            const option = select.options[select.selectedIndex];
            const stockCount = option.getAttribute('data-stock') || 0;
            const stockInfo = select.parentElement.querySelector('.stock-count');
            stockInfo.textContent = stockCount;
        }

        function checkStock(input) {
            const row = input.closest('.row');
            const select = row.querySelector('select');
            const option = select.options[select.selectedIndex];
            const stockCount = parseInt(option.getAttribute('data-stock') || 0);
            const quantity = parseInt(input.value) || 0;

            if (quantity > stockCount) {
                input.classList.add('is-invalid');
                const warning = row.querySelector('.stock-warning') || document.createElement('div');
                warning.className = 'stock-warning';
                warning.textContent = `Số lượng vượt quá tồn kho (${stockCount})`;
                if (!row.querySelector('.stock-warning')) {
                    row.querySelector('.col-md-2').appendChild(warning);
                }
            } else {
                input.classList.remove('is-invalid');
                const warning = row.querySelector('.stock-warning');
                if (warning) {
                    warning.remove();
                }
            }
        }

        // Calculate total when quantity or price changes
        document.addEventListener('input', function(e) {
            if (e.target.matches('input[type="number"]')) {
                const row = e.target.closest('.row');
                const quantity = row.querySelector('input[type="number"]:nth-of-type(1)').value;
                const price = row.querySelector('input[type="number"]:nth-of-type(2)').value;
                const total = quantity * price;
                row.querySelector('input[readonly]').value = total.toLocaleString('vi-VN') + ' VNĐ';
            }
        });
    </script>
</body>
</html> 